algorithm calcul varianc lese statist algorithm statist deviat dispers articl exampl pseudocod algorithm calcul varianc play major role statist comput key problem design good algorithm thi problem formula varianc involv sum squar lead numer instabl well arithmet overflow deal larg valu nav algorithm formula calcul varianc entir popul size displaystylefrac sum_ sum_ x_i formula calcul unbias estim popul varianc finit sampl observ displaystylefrac sum_ sum_ x_i therefor naiv algorithm calcul estim varianc follow pseudocod sum sum_sqr foreach data sum sum sum_sqr sum_sqr sumn varianc sum_sqr sum thi algorithm easili adapt comput varianc finit popul simpli divid minu becaus sum_sqr sum veri number precis result inher precis floatingpoint arithmet perform comput thi particularli bad varianc small rel sum number ii twopass algorithm altern approach differ formula varianc follow pseudocod foreach data foreach data varianc thi algorithm numer reliabl nav algorithm larg set data wors data veri close precis equal quit result simpl algorithm ii depend inordin order data poor result veri larg data set repeat roundoff error accumul sum techniqu compens summat combat thi error degre iia compens variant compensatedsumm version algorithm abov read foreach data sumc foreach data sumc sumc varianc iii onlin algorithm abl comput varianc singl pass inspect valu x_i onli onc exampl data collect storag valu cost memori access domin comput onlin algorithm recurr relat requir quantiti requir statist calcul numer stabl fashion follow formula updat estim varianc sequenc addit element x_ mathrm denot estim popul sampl estim popul varianc estim sampl varianc number element sequenc befor addit m_ mathrm frac m_ mathrm x_ mathrm m_ mathrm frac x_ mathrm m_ mathrm mathrm frac mathrm x_ mathrm m_ mathrm x_ mathrm m_ mathrm mathrm gt mathrm frac mathrm x_ mathrm m_ mathrm x_ mathrm m_ mathrm turn suitabl quantiti updat sum squar differ current sum_ x_i denot m_mathrm m_mathrm x_mathrm m_mathrm x_mathrm m_mathrm frac frac numer stabl algorithm comput thi algorithm knuth cite welford foreach data delta deltan delta thi express valu variance_n varianc thi algorithm prone loss precis massiv cancel effici becaus divis oper insid loop particularli robust twopass algorithm comput varianc comput subtract estim thi algorithm residu slightli conveni form allow calcul standard deviat explicitli calcul number element sequenc addit element ha mathrm frac mathrm frac left x_text m_text right iv weight increment algorithm observ weight west thi increment algorithm foreach data sumweight weight els temp weight sumweight sumweight weight xmean temp xmean weight temp sumweight temp varianc sumweight sampl popul omit parallel algorithm chan al note abov onlin algorithm iii special case algorithm work ani partit sampl set xa xb delta mb ma mx ma deltacdotfrac nb nx na nb nx thi exampl multipl process unit assign discret input higherord statist terriberri extend chan formula calcul third fourth central moment exampl estim skew kurtosi na nb na nb nx nx begin align na nb left na na nb nb nx na nb nx nx end align m_k sum power differ sigma overlin skew frac sqrt kurtosi frac increment case ie thi simplifi delta frac delta frac frac frac frac frac frac note preserv valu delta onli divis oper thu higherord statist calcul littl increment cost exampl assum float point oper standard ieee doubleprecis arithmet consid sampl infinit popul base thi sampl estim popul unbias estim popul varianc algorithm algorithm ii comput valu correctli consid sampl rise estim varianc sampl algorithm ii comput thi varianc estim correctli algorithm return thi loss precis toler view minor flaw algorithm easi find data reveal major flaw naiv algorithm sampl estim popul varianc comput correctli algorithm ii naiv algorithm comput minu thi seriou problem algorithm sinc varianc definit neg comput formula varianc refer donald knuth art comput program volum seminumer algorithm edn boston addisonwesley welford note method calcul correct sum squar product technometr west commun acm updat varianc estim improv method chan toni golub gene levequ randal updat formula pairwis algorithm comput sampl varianc technic report depart comput scienc stanford univers terriberri timothi comput higherord moment onlin extern link eric weisstein sampl varianc comput mathworld