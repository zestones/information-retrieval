cryptgenrandom grahambould pseudorandom number gener microsoft window secur technolog cryptograph secur pseudorandom number gener microsoft applic program interfac cryptograph algorithm cryptgenrandom crytograph secur pseudorandom number gener function includ microsoft cryptograph applic program interfac program microsoft recommend anywher random number gener paper hebrew univers secur problem window implement cryptgenrandom assum attack ha control machin microsoft acknowledg problem exist window xp vista novemb microsoft claim bug releas window xp servic pack releas occur background api includ comprehens support cryptograph secur includ nativ tl support schannel api code sign capabl built nativ window librari cryptograph oper rsa ae key gener librari turn reli cryptograph secur pseudorandom number gener csprng cryptgenrandom standard csprng program environ method oper microsoftprovid cryptographi provid share implement cryptgenrandom current base intern function call rtlgenrandom onli gener outlin algorithm publish rtlgenrandom gener specifi fip appendix function entropi current process getcurrentprocessid current thread getcurrentthreadid tick count sinc boot time gettickcount current time getlocaltim variou highprecis perform counter queryperformancecount hash user environ block includ usernam comput search path highprecis intern cpu counter rdtsc rdmsr rdpmc omit long list lowlevel system inform field perform counter sourc write secur code second edit isbn secur secur cryptosystem csprng signific becaus origin dynam key materi key fli ae tl session key protect http session bank websit origin csprng pseudorandom number predict session key predict well becaus cryptgenrandom de facto standard csprng environ secur critic window user specif cryptgenrandom algorithm offici publish ani unpublish random number gener algorithm suscept theoret weak includ outdat algorithm relianc entropi gather sever monotonicallyincreas counter estim control extent attack local access system hebrew univers cryptanalysi cryptanalysi cryptgenrandom publish novemb leo dorrendorf hebrew univers jerusalem univers haifa signific weak window implement algorithm advantag hebrew univers vulner attack compromis program random number gener weak paper depend attack siphon bit gener attack posit carri thi attack typic alreadi posit defeat ani random number gener instanc simpli sniff output gener memori valu howev hebrew univers team note attack onli steal bit onc order persist violat secur cryptgenrandom instanc inform glean determin random number gener potenti compromis inform credit card number alreadi paper attack base fact cryptgenrandom stream cipher backward onc advantag fact cryptgenrandom user mode allow anyon gain access oper system user level exampl exploit buffer overflow cryptgenrandom inform process final cryptgenrandom refresh seed entropi infrequ thi problem aggrav fact process ha instanc cryptgenrandom thi compromis process doe transit compromis everi process increas longev ani success break becaus detail cryptgenrandom algorithm public dorrendorf team revers engin tool includ ollydbg ida pro discern algorithm work result paper publish record window cryptograph random number gener oper common criteria window xp success undergon evalu includ cryptgenrandom fipsgenrandom implement secur target document avail common criteria portal indic complianc requir conclus drawn secur algorithm result measur product best practic secur object rare involv indepth cryptanalysi fip valid microsoft ha valid rng implement follow environ window vista rng implement certif window enhanc cryptograph provid rsaenhdll certif window enhanc dss diffiehellman cryptograph provid dssenhdll certif window kernel mode cryptograph modul fipssi certif window ce window mobil enhanc cryptograph provid rsaenhdll certif window ce window mobil enhanc cryptograph provid rsaenhdll certif window ce enhanc cryptograph provid rsaenhdll certif test design test conform variou approv rng specif provid measur product secur thu valid interpret evalu endors overal product secur conclus drawn secur algorithm result fip evalu necessarili inspect sourc code evalu rng seed gener sourc code access program number sourc code access program offer microsoft usual protect veri explicit eula provid access sourc code otherwis share gener public disassembl runtim librari window platform disassembl offtheshelf tool ida pro objdump addit unlik closedsourc vendor microsoft provid debug symbol releas binari result microsoft binari evalu thirdparti secur practition cryptanalysi dorrendorf al mention abov base disassembl altern api level window develop sever altern access cryptgenrandom function altern invok algorithm share secur characterist advantag rtlgenrandom histor alway told develop function rand gener key nonc password function cryptgenrandom creat cryptograph secur random number problem cryptgenrandom pull cryptoapi cryptacquirecontext fine re crypto function default window xp instal cryptgenrandom call function rtlgenrandom doe requir load cryptapi stuff fact whidbey crt function rand_ call rtlgenrandom rngcryptoserviceprovid programm net rngcryptoserviceprovid class program languag python function urandom os modul devurandom unixbas system call cryptgenrandom window system refer microsoft confirm xp random number gener bug rtlgenrandom function window dorrendorf leo zvi gutterman benni pinkas cryptanalysi random number gener window oper system pdf http csrcnistgovcryptvalrngrngvspdf michael howard web log cryptograph secur random number window cryptoapi http python librari refer os modul cryptographi portal cryptograph secur pseudorandom number gener random number gener attack extern link microsoft document cryptgenrandom cryptograph secur random number window cryptoapi overview window common criterion evalu microsoft share sourc licens program microsoft fip evalu