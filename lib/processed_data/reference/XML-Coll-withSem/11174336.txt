inplac matrix transposit thenickdud numer linear algebra permut inplac matrix transposit call insitu matrix transposit problem transpos time matrix inplac comput memori ideal bound addit storag addit storag nm typic matrix assum store rowmajor order columnmajor order ie contigu row column respect arrang consecut perform inplac transpos insitu transpos difficult neq ie nonsquar rectangular matrix involv complic permut data element mani cycl length greater contrast squar matrix cycl length transpos achiev simpl loop swap upper triangl matrix lower triangl complic aris maxim memori local howev improv cach util oper outofcor matrix doe fit main memori sinc transpos inher involv nonconsecut memori access problem nonsquar inplac transposit ha studi sinc late sever algorithm includ sever attempt optim local cach outofcor memoryrel context background comput avoid explicitli transpos matrix memori simpli access data differ order exampl softwar librari linear algebra bla typic provid option specifi matric interpret transpos order avoid necess data movement howev remain number circumst necessari desir physic reorder matrix memori transpos order exampl matrix store rowmajor order row matrix contigu memori column discontigu repeat oper perform column exampl fast fourier transform algorithm eg frigo johnson transpos matrix memori column contigu improv perform increas memori local sinc situat normal coincid case veri larg matric exceed cach size perform transposit inplac minim addit storag becom desir pure mathemat problem inplac transposit involv number interest number theori puzzl work cours sever decad exampl exampl consid matrix begin bmatrix bmatrix rowmajor format thi store comput memori sequenc ie row store consecut transpos thi matrix begin bmatrix bmatrix store comput memori sequenc number storag locat left thi permut consist cycl posit goe posit cycl length data motion posit goe posit goe posit posit goe posit similarli posit posit properti permut follow assum time matrix store rowmajor order zerobas indic thi element ldot ldot store address mn plu offset memori ignor transpos time matrix correspond element store address nm rowmajor order defin transposit permut function nm mn in time thi defin permut number ldot turn defin simpl formula invers cate twigg left begin matrix mn mbox mn mod mn mbox otherwis end matrix right mod modulo oper proof leq mn lt mn mod mn nm mod mn nm note mn mod mn mod leq lt mn note element alway left invari transposit second invers permut left begin matrix mn mbox mn ma mod mn mbox otherwis end matrix right thi consequ fact invers time transpos time transpos easi explicitli compos ident prove cate twigg number point cycl length permut precis gcd minu minu gcd greatest common divisor exampl number point simpli diagon matrix minu minu coprim hand onli point upperleft lowerright corner matrix number cycl ani length gt cate twigg frac sum_ mu kd gcd nd mn mbiu function sum divisor furthermor cycl ie second element row matrix alway cycl maximum length length cycl divisor cate twigg cycl everi element in ha greatest common divisor gcd mn proof brenner smallest element cycl gcd mn definit permut abov everi element cycl repeatedli multipli modulo mn minu therefor everi element divis sinc mn minu coprim divis ani factor mn minu larger henc gcd mn thi theorem search cycl permut sinc effici search onli multipl divisor mn minu brenner laflin brebner point cycl pair exploit sever algorithm permut pair cycl time smallest element cycl length follow mn minu minu element cycl length possibl cycl proof definit abov length cycl smallest gt nk mod mn clearli thi smallest gt nk mod mn sinc multipli side minu mod mn algorithm follow briefli summar publish algorithm perform inplac matrix transposit sourc code implement algorithm refer squar matric squar time matrix a_ inplac transposit easi becaus cycl length diagon a_ length upper triangl swap lower triangl pseudocod accomplish thi assum zerobas array indic swap thi type implement simpl exhibit poor perform poor cachelin util especi power cachelin conflict cpu cach limit associ reason thi increment inner loop memori address correspond jump discontigu memori depend array columnmajor rowmajor format respect algorithm doe exploit possibl spatial local solut improv cach util block algorithm oper sever number onc block cachelin size unfortun thi algorithm depend size cach cacheawar modern comput multipl level cach requir multipl level machinedepend block ha frigo al better perform recurs algorithm divid matrix submatric roughli equal size transpos submatric diagon recurs transpos swap submatric abov diagon suffici small simpl algorithm abov base case naiv recurs excess functioncal overhead thi cacheoblivi algorithm sens exploit cach cachelin size explicit paramet follow cycl nonsquar matric algorithm complic mani algorithm prior describ followthecycl algorithm loop cycl move data locat cycl pseudocod form length gt cycl permut pick start address data predecessor cycl move data successor predecessor move data successor differ algorithm lie mainli locat cycl find start address cycl ensur cycl move exactli onc typic discuss abov cycl move pair sinc mn minu minu cycl length possibl cycl sometim small scratch array typic length eg brenner cate twigg track subset locat array visit acceler algorithm order determin cycl ha move alreadi simplest scheme mn auxiliari storag bit element indic element ha move onli log mn auxiliari storag complic algorithm requir algorithm worstcas linearithm comput cost mn log mn best prove knuth fich al gustavson swirszcz algorithm design move data element exactli onc howev involv consider amount arithmet comput cycl requir heavili nonconsecut memori access sinc adjac element cycl differ multipl factor discuss abov improv memori local cost greater total data movement sever algorithm design achiev greater memori local cost greater data movement well slightli greater storag requir move data element onc involv consecut memori access greater spatial local improv perform modern cpu reli cach well simd architectur optim process consecut data block oldest context spatial local transposit studi outofcor oper alltop matrix larg fit main memori core exampl gcd small perform transposit small amount nm addit storag three pass array alltop dow pass involv sequenc separ small transposit perform effici place small buffer involv inplac time squar transposit block effici sinc block move larg consecut cycl length case minu small dow describ anoth algorithm requir minu min addit storag involv min time min squar transpos preced follow small outofplac transpos frigo johnson describ adapt algorithm cacheoblivi techniqu generalpurpos cpu reli cach exploit spatial local work outofcor matrix transposit matrix doe fit main memori store larg hard disk ha focus larg squarematrix case eg alltop review outofcor algorithm especi appli parallel comput eg suh prasanna krishnamoorth al refer windley transpos matric digit comput comput journal pall seiden problem abelian group applic transposit matrix electron comput math comp boothroyd algorithm transpos vector store array acm transact mathemat softwar susan laflin brebner algorithm insitu transposit rectangular matrix acm transact mathemat softwar sourc code norman brenner algorithm matrix transposit place acm transact mathemat softwar sourc code alltop comput algorithm transpos nonsquar matric ieee tran comput esko cate david twigg algorithm analysi insitu transposit acm transact mathemat softwar sourc code murray dow transpos matrix vector comput parallel comput donald knuth art comput program volum fundament algorithm third edit exercis addisonwesley york frigo leiserson prokop ramachandran cacheoblivi algorithm proceed ieee symposium foundat comput scienc foc extend abstract ieee cites suh prasanna effici algorithm outofcor matrix transposit ieee tran comput krishnamoorthi baumgartn cociorva cc lam sadayappan effici parallel outofcor matrix transposit intern journal high perform comput network frigo johnson design implement proceed ieee sourc code fftw librari includ optim serial parallel squar nonsquar transpos addit fft faith fich ian munro patricio poblet permut place siam journal comput fred gustavson tadeusz swirszcz inplac transposit rectangular matric lectur note comput scienc proceed workshop stateoftheart sic scientif parallel comput para ume sweden june sequenc number nonsingleton cycl insitu transposit onlin encyclopedia integ sequenc sequenc length longest cycl insitu transposit onlin encyclopedia integ sequenc sequenc number point minu insitu transposit onlin encyclopedia integ sequenc extern link sourc code offt recurs block inplac transpos squar matric fortran jason strato papadopoulo block inplac transpos squar matric scimathnumanalysi newsgroup april sourc code link refer abov addit code perform inplac transpos squar nonsquar matric