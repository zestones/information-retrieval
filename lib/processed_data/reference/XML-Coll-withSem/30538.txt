transmiss control protocol kgfleischmann wikipedia articl clarif selfcontradictori articl transport layer protocol tcpip transmiss control protocol tcp core protocol internet protocol suit tcp central entir suit refer tcpip wherea ip handl lowerlevel transmiss comput comput messag internet tcp oper higher level concern onli system exampl web browser web server tcp provid reliabl order deliveri stream byte program comput anoth program anoth comput besid web common applic tcp includ email file transfer manag task tcp control messag size rate messag exchang network traffic congest tcpip model rfc applic layer bgp dhcp dn ftp gopher gtp http imap irc nntp ntp pop rip rpc rtcp rtp rtsp sdp sip smtp snmp soap ssh ssl stun telnet tl xmpp applic layer protocols transport layer tcp udp dccp sctp rsvp ecn transport layer protocols internet layer ip icmp igmp ipsec internet layer protocols link layer arp rarp ndp ospf tunnel media access control devic driver link protocols reason tcp tcp provid commun servic intermedi level applic program internet protocol ip applic program desir send larg chunk data internet ip break data ipsiz piec issu seri ip request softwar issu singl request tcp tcp handl ip detail ip work exchang piec inform call packet packet sequenc byte consist header follow bodi header describ packet destin router internet pass packet gener direct arriv final destin bodi data ip transmit ip transmit data behalf tcp content ip packet bodi tcp data network congest traffic load balanc unpredict network behavior ip packet lost deliv order tcp detect problem request retransmiss lost packet rearrang outoford packet help minim network congest reduc occurr problem onc tcp receiv ha final reassembl perfect copi larg data chunk origin transmit pass singl chunk applic program receiv thu tcp greatli simplifi applic programm network commun task applic tcp extens mani internet popular applic protocol result applic includ wide web email file transfer protocol secur shell stream media applic howev becaus tcp optim accur deliveri time deliveri tcp sometim incur rel long delay order second wait outoford messag retransmiss lost messag particularli suitabl realtim applic voic ip applic protocol realtim transport protocol rtp user datagram protocol udp usual recommend tcp reliabl stream deliveri servic guarante deliveri data stream host anoth duplic lose data sinc packet transfer reliabl techniqu posit acknowledg retransmiss guarante reliabl packet transfer thi fundament techniqu requir receiv respond acknowledg messag receiv data sender record packet send wait acknowledg befor send packet sender timer packet wa retransmit packet timer expir timer case packet becom lost corrupt tcp transmiss control protocol consist set rule protocol internet protocol ip send data form messag unit comput internet time ip care handl actual deliveri data tcp care track individu unit data packet accur segment messag divid effici rout net exampl html file web server tcp program layer server file stream byte divid segment number segment forward individu ip program layer ip program layer turn tcp segment ip packet ad header includ thing destin ip address everi packet ha destin ip address rout differ network client program comput tcp stack implement reassembl individu segment ensur correctli order stream applic tcp segment structur tcp segment consist header data tcp header http freebiefatpipeorgmjbdrawingstcp_headerpng consist field onli requir eleventh field option pink background tabl aptli option tcp header bit offset bit sourc port destin port sequenc number acknowledg number data offset reserv cwr ece urg ack psh rst syn fin window size checksum urgent pointer option option data sourc port bit identifi send port destin port bit identifi receiv port sequenc number bit ha dual role syn flag thi initi sequenc number sequenc number data byte thi sequenc number plu syn flag thi sequenc number data byte acknowledg number bit ack flag set valu thi field expect byte receiv expect data offset bit specifi size tcp header word minimum size header word maximum word thu minimum size byte maximum byte thi field fact offset start tcp packet data reserv bit futur set flag bit aka control bit flag cwr bit congest window reduc cwr flag set send host indic receiv tcp segment ece flag set ad header rfc ece ecnecho bit indic tcp peer ecn capabl dure handshak ad header rfc urg bit indic urgent pointer field signific ack bit indic acknowledg field signific psh bit push function rst bit reset connect syn bit synchron sequenc number fin bit data sender window bit size receiv window specifi number byte sequenc number acknowledg field receiv current will receiv flow control checksum bit checksum field errorcheck header data urgent pointer bit urg flag set thi field offset sequenc number indic urgent data byte option variabl bit total length option field multipl word data offset field adjust appropri option list oper nop pad maximum segment size maximum segment size window scale window scale detail select acknowledg select acknowledg detail timestamp tcp timestamp detail field header content thi field whatev upper layer protocol thi protocol set header presum base port select data variabl bit expect thi payload data portion tcp packet payload ani number applic layer protocol common http telnet ssh ftp popular protocol tcp protocol oper accuraci disput class mboxtext style thi appear contradict activepass close pleas help thi problem unlik tcp tradit counterpart user datagram protocol immedi start send packet tcp provid connect establish befor send data tcp connect three phase connect establish data transfer connect termin befor describ three phase note variou connect endpoint internet socket listen synsent synreceiv establish closewait close lastack timewait close listen repres wait connect request ani remot tcp port usual set tcp server synsent repres wait remot tcp send tcp packet syn ack flag set usual set tcp client synreceiv repres wait remot tcp send acknowledg connect acknowledg remot tcp usual set tcp server establish repres port readi receivesend data fromto remot tcp set tcp client server timewait repres wait time pass remot tcp receiv acknowledg connect termin request accord rfc connect stay timewait maximum minut connect establish establish connect tcp threeway handshak befor client attempt connect server server bind port open connect thi call passiv open onc passiv open establish client initi activ open establish connect threeway handshak occur activ open perform client send syn server respons server repli synack final client send ack server thi point client server receiv acknowledg connect exampl initi host client send synchron packet syn flag set initi connect set packet sequenc number random valu host receiv packet record sequenc number client repli acknowledg synchron synack acknowledg field tcp segment header sequenc number thi host expect receiv host initi return session thi includ tcp segment initi sequenc number valu initi host respond sequenc number simpl acknowledg number valu sequenc number valu host data transfer key featur set tcp apart user datagram protocol order data transfer destin host rearrang accord sequenc number retransmiss lost packet ani cumul stream acknowledg will retransmit discard duplic packet errorfre data transfer flow control limit rate sender transfer data guarante reliabl deliveri receiv host buffer fill acknowledg window size transfer allow data buffer process congest control slide window order data transfer retransmiss lost packet discard duplic packet tcp sequenc number identifi byte data sequenc number identifi order byte comput data transfer reliabl order ani fragment disord packet loss occur dure transmiss everi byte transmit sequenc number increment step handshak comput exchang initi sequenc number isn thi number arbitrari fact unpredict order avoid tcp sequenc predict attack tcp primarili cumul acknowledg scheme receiv send acknowledg signifi receiv ha receiv data preced acknowledg sequenc number essenti data byte segment assign sequenc number insert sequenc number field receiv send acknowledg specifi sequenc number byte expect receiv exampl comput send byte sequenc number conceptu byte sequenc number assign receiv send acknowledg sinc byte expect receiv packet send acknowledg receiv signal receiv byte correctli chanc byte corrupt acknowledg valu sinc receiv success addit cumul acknowledg tcp receiv send select acknowledg provid inform select acknowledg sender infer data ha lost network retransmit data errorfre data transfer sequenc number acknowledg cover discard duplic packet retransmiss lost packet ordereddata transfer assur correct checksum field includ tcp segment structur detail checksum tcp checksum quit weak check modern standard data link layer high bit error rate requir addit link error correctiondetect capabl tcp redesign today probabl cyclic redund check specifi error check current checksum weak checksum partial compens common crc better integr check layer tcp ip ppp ethernet frame howev thi doe tcp checksum redund remark introduct error packet crcprotect hop common endtoend tcp checksum catch simpl error thi endtoend principl work flow control tcp endtoend flow control protocol avoid sender send data fast tcp receiv reliabl receiv process mechan flow control essenti environ machin divers network speed commun exampl fast pc send data slow handheld pda pda regul influx data protocol softwar overrun quickli similarli flow control essenti applic receiv data read slowli send applic send tcp slide window flow control protocol tcp segment receiv specifi receiv window field amount addit receiv data byte will buffer connect send host send onli amount data befor wait acknowledg window updat receiv host tcp sequenc number receiv window behav veri clock receiv window shift time receiv receiv acknowledg segment data onc sequenc number sequenc number loop receiv advertis window size sender send data start persist timer persist timer protect tcp deadlock situat aris window size updat receiv lost receiv ha data send sender wait window size updat persist timer expir tcp sender send small packet receiv send acknowledg window size receiv process incom data small increment repeatedli advertis small receiv window thi refer silli window syndrom sinc ineffici send onli byte data tcp segment rel larg overhead tcp header tcp sender receiv typic employ flow control logic specif avoid repeatedli send small segment sendersid silli window syndrom avoid logic refer nagl algorithm congest control final main aspect tcp congest control tcp number mechan achiev high perform avoid congest collaps network perform fall sever order magnitud mechan control rate data enter network data flow rate trigger collaps acknowledg data lack acknowledg sender infer network condit tcp sender receiv coupl timer tcp sender receiv alter behavior flow data thi gener refer congest control andor network congest avoid modern implement tcp intertwin algorithm slowstart congest avoid fast retransmit fast recoveri addit sender employ retransmiss timer base estim roundtrip time rtt sender receiv well varianc thi round trip time behavior thi timer specifi rfc subtleti estim rtt exampl sender care calcul rtt sampl retransmit packet typic karn algorithm tcp timestamp rfc individu rtt sampl averag time creat smooth round trip time srtt jacobson algorithm thi srtt valu final roundtrip time estim enhanc tcp reliabl handl loss minim error manag congest fast veri highspe environ ongo area standard develop result number tcp congest avoid algorithm variat maximum segment size maximum segment size mss largest amount data specifi byte tcp will send singl segment best perform mss set small avoid ip fragment lead excess retransmiss packet loss tri accomplish thi typic mss negoti mss option tcp connect establish case determin maximum transmiss unit mtu size data link layer network sender receiv directli attach furthermor tcp sender path mtu discoveri infer minimum mtu network path sender receiv thi dynam adjust mss order avoid ip fragment network select acknowledg reli pure cumul acknowledg scheme employ origin tcp protocol lead ineffici packet lost exampl suppos byte differ tcp packet packet lost dure transmiss pure cumul acknowledg protocol receiv receiv byte success fail receiv packet byte thu sender resend byte order solv thi problem tcp employ select acknowledg sack option defin rfc allow receiv acknowledg discontigu block packet receiv correctli addit sequenc number contigu byte receiv success basic tcp acknowledg acknowledg specifi number sack block sack block convey start sequenc number contigu rang receiv correctli receiv exampl abov receiv send sack sequenc number sender will thu retransmit onli packet byte sack option mandatori onli parti support thi negoti connect establish sack option tcp header tcp segment structur detail sack widespread popular tcp stack support select acknowledg sctp window scale main articl tcp window scale option effici high bandwidth network larger tcp window size tcp window size field control flow data limit byte sinc size field expand scale factor tcp window scale option defin rfc option increas maximum window size byte gigabyt scale larger window size necessari tcp tune window scale option onli dure tcp handshak window scale valu repres number bit leftshift window size field window scale valu set shift mani router packet firewal rewrit window scale factor dure transmiss thi caus send receiv side assum differ tcp window size result nonstabl traffic veri slow problem visibl send receiv site path broken router tcp window scale problem linux window vista system tcp timestamp tcp timestamp defin rfc help tcp comput roundtrip time sender receiv timestamp option includ timestamp valu sender insert current valu timestamp clock echo repli timestamp valu receiv gener insert timestamp valu ha receiv sender echo repli timestamp acknowledg comput total elaps time sinc acknowledg segment wa tcp timestamp help case tcp sequenc number encount bound wrap sequenc number space thi scheme protect wrap sequenc number paw rfc detail band data abl interrupt abort queu stream wait stream finish thi specifi data urgent thi will receiv program process immedi rest urgent data finish tcp inform applic resum stream queue exampl tcp remot login session user send keyboard sequenc interrupt abort program signal program remot machin fail oper correctli signal wait program finish current transfer unfortun tcp oob data wa design modern internet urgent pointer onli alter process remot host doe nt expedit ani process network remot host slightli differ interpret protocol onli singl byte oob data reliabl thi assum reliabl commonli protocol element tend poorli implement forc data deliveri normal tcp wait buffer exceed maximum segment size befor send ani data thi creat seriou delay side connect exchang short messag receiv respons befor continu exampl login sequenc session short messag login session ani progress charact transmit respons ha receiv thi process serious delay tcp normal behavior howev applic forc deliveri octet output stream push oper provid tcp applic layer thi oper caus tcp set psh flag control bit ensur data will deliv immedi applic layer receiv transport layer extrem case exampl user expect keystrok echo receiv applic push oper time keystrok occur gener applic program thi function forc output write charact charact forc data immedi delay wait time reduc connect termin connect termin phase fourway handshak side connect termin independ endpoint half connect transmit fin packet acknowledg ack therefor typic teardown requir pair fin ack segment tcp endpoint connect halfopen case side ha termin ha side ha termin longer send ani data receiv ani data connect side gener tri thi result acknowledg therefor timeout els result posit rst therebi destruct halfopen socket possibl termin connect handshak host send fin host repli fin ack mere combin step host repli ack thi perhap common method possibl host send fin simultan ack thi possibl consid handshak sinc finack sequenc parallel direct host tcp stack implement halfduplex close sequenc linux hpux host activ close connect ha read incom data stack alreadi receiv link thi host will send rst fin rfc thi allow tcp applic remot applic ha read data wait fin remot side will activ close connect unfortun remot tcp stack distinguish connect abort rst thi data loss rst will remot stack throw data receiv applic nt read applic protocol violat osi model layer tcp openclos handshak applic protocol openclos handshak find rst problem activ close exampl connect remot send data close usual program flow abov tcpip stack describ abov doe guarante data will arriv applic programm remot side will send anyth vulner vulner denial servic spoof ip address repeatedli send purpos assembl syn packet attack caus server consum larg amount resourc track bogu connect thi syn flood attack propos solut thi problem includ syn cooki cryptograph puzzl connect hijack attack abl eavesdrop tcp session redirect packet hijack tcp connect attack learn sequenc number ongo commun forg fals packet packet stream simpl hijack result packet erron accept receiv host acknowledg extra packet side connect synchron lost hijack combin arp rout attack allow control packet flow perman control hijack tcp connect imperson differ ip address wa possibl prior rfc initi sequenc number wa easili guessabl allow attack blindli send sequenc packet receiv believ differ ip address deploy arp rout attack ensur legitim host imperson ip address bring condit denial servic attack thi whi initi sequenc number chosen random tcp port main articl tcp udp port tcp notion port number identifi send receiv applic endpoint host internet socket side tcp connect ha associ unsign port number reserv send receiv applic arriv tcp data packet identifi belong specif tcp connect socket combin sourc host address sourc port destin host address destin port thi server comput provid sever client sever servic simultan long client care initi ani simultan connect destin port differ sourc port port number categor three basic categori wellknown regist dynamicpriv wellknown port assign internet assign number author iana typic systemlevel root process wellknown applic server passiv listen connect typic port exampl includ ftp ssh telnet smtp http regist port typic user applic ephemer sourc port contact server identifi servic regist third parti dynamicpriv port user applic commonli dynamicpriv port ani outsid ani tcp connect develop tcp complex evolv protocol howev signific enhanc propos year basic oper ha chang significantli sinc specif rfc specif rfc publish septemb http rfc host requir internet host clarifi number tcp protocol implement requir rfc tcp congest control import tcprelat rfc year describ updat algorithm order avoid undu congest rfc wa written describ explicit congest notif ecn congest avoid signal mechan origin tcp congest avoid algorithm wa tcp taho mani altern algorithm sinc propos includ tcp reno tcp vega fast tcp tcp reno tcp hybla tcp interact itcp effort tcp extens allow applic subscrib tcp event regist handler compon launch applic variou purpos includ applic assist congest control tcp wireless tcp ha optim wire network ani packet loss consid result congest congest window size reduc dramat precaut howev wireless link experi sporad usual temporari loss fade shadow hand radio consid congest erron backoff congest window size wireless packet loss congest avoid phase conserv decreas window size thi caus radio link underutil extens ha subject combat harm solut categor endtoend solut requir modif client andor server link layer solut rlp proxi base solut requir chang network modifi node hardwar implement overcom process power requir tcp build hardwar implement wide tcp offload engin toe main problem toe hard integr comput system requir extens chang oper system comput devic compani develop devic wa alacritech debug packet sniffer intercept tcp traffic network link debug network network stack applic tcp user packet pass link network stack support so_debug socket option enabl socket setsockopt option dump packet tcp event socket will help debug netstat anoth util debug altern mani applic tcp appropri big problem normal implement applic packet lost packet retransmit copi lost packet receiv thi caus problem realtim applic stream multimedia internet radio realtim multiplay game voic ip voip sometim data time fashion data order histor perform reason storag area network san prefer fibr channel protocol fcp tcpip embed system network boot server serv simpl request huge number client eg dn server complex tcp problem final trick transmit data host nat stun system simpler rel complex protocol tcp gener tcp unsuit user datagram protocol udp thi provid applic multiplex checksum tcp doe doe handl build stream retransmiss applic develop abil code suitabl situat andor replac method forward error correct interpol sctp anoth ip protocol provid reliabl stream orient servic dissimilar tcp newer consider complex tcp ha widespread deploy howev especi design situat reliabl nearrealtim consider import venturi transport protocol vtp patent proprietari protocol design replac tcp transpar order overcom perceiv ineffici relat wireless data transport tcp ha issu high bandwidth util environ tcp congest avoid algorithm work veri well adhoc environ will send data environ predict time base protocol atm avoid overhead retransmit tcp field comput checksum tcp checksum tcp method comput checksum defin rfc checksum field bit complement complement sum word header text segment odd number header text octet checksum octet pad form word checksum purpos pad transmit segment comput checksum checksum field replac word appropri pad word ad complement arithmet sum bitwis complement insert checksum field pseudohead mimic header checksum comput tabl tcp pseudohead bit offset bit sourc address destin address protocol tcp length sourc port destin port sequenc number acknowledg number data offset reserv flag window checksum urgent pointer option option data sourc destin address header protocol valu tcp cf list ip protocol number tcp length field length tcp header data tcp checksum tcp method comput checksum chang rfc ani transport upperlay protocol includ address ip header checksum comput modifi includ address address pseudohead comput checksum tcp pseudohead bit offset bit sourc address destin address tcp length header sourc port destin port sequenc number acknowledg number data offset reserv flag window checksum urgent pointer option option data sourc address header destin address final destin packet doe nt rout header will destin address header otherwis origin node will address element rout header receiv node will destin address header tcp length length tcp header data header protocol valu tcp connectionori protocol ttcp variant tcp tcp udp port tcp udp port number long list portsservic tcp congest avoid algorithm nagl algorithm karn algorithm maximum transmiss unit ip fragment maximum segment size silli window syndrom tcp segment tcp sequenc predict attack syn flood syn cooki tcp tune high perform network path mtu discoveri tcphdr unix tcp header structur program languag sctp transport protocol comparison tabl refer comer dougla internetwork tcpip principl protocol architectur prentic hall isbn stone partridg crc tcp checksum disagre sigcomm tanenbaum andrew comput network fourth edit prentic hall isbn laurent joncheray simpl activ attack tcp http tcp interact itcp read richard steven tcpip illustr volum protocol isbn richard steven gari wright tcpip illustr volum implement isbn richard steven tcpip illustr volum tcp transact http nntp unix domain protocol isbn extern link tcp handshak exampl dissert tcp improv wire wireless network dissert iana port assign john kristoff overview tcp fundament concept tcp transport data endpoint rfc specif internet transmiss control program decemb version rfc tcp rfc errorcorrect rfc tcpextens rfc extend tcp transact concept rfc defend sequenc number attack rfc tcp select acknowledg option rfc tcp congest control rfc comput tcp retransmiss timer rfc roadmap tcp specif document tcp transmiss control protocol tcp efsm diagram detail descript tcp basic transmiss control protocol law leaki abstract joel spolski checksum exampl