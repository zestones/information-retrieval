constraint algorithm jits niesen comput physic molecular physic numer differenti equat molecular dynam comput chemistri mechan constraint algorithm method satisfi constraint bodi obey newton equat motion three basic approach satisfi constraint choos novel unconstrain coordin intern coordin introduc explicit constraint forc minim constraint forc implicitli techniqu lagrang multipli project method constraint algorithm appli molecular dynam simul simul sometim carri intern coordin automat satisfi bondlength bondangl constraint carri explicit implicit constraint forc bond length bond angl explicit constraint forc typic shorten timestep significantli simul effici comput word comput power requir comput trajectori length therefor intern coordin implicitforc constraint solver gener prefer mathemat background motion set particl describ set secondord ordinari differenti equat newton second law written matrix form mathbf cdot frac mathbf dt mathbf frac partial partial mathbf mass matrix vector gener coordin describ particl posit exampl vector cartesian coordin particl posit absenc constraint diagon squar matrix particl mass vector repres gener forc scalar repres potenti energi function gener coordin constraint coordin satisfi timeindepend algebra equat g_ mathbf breviti function gi group dimension vector task solv combin set differentialalgebra dae equat ordinari differenti equat ode newton second law thi problem wa studi detail joseph loui lagrang laid method solv simplest approach defin gener coordin unconstrain thi approach elimin algebra equat reduc problem onc solv ordinari differenti equat approach exampl describ motion rigid bodi posit orient rigid bodi describ independ unconstrain coordin describ posit particl constraint maintain rel distanc drawback thi approach equat becom unwieldi complex exampl mass matrix becom nondiagon depend gener coordin second approach introduc explicit forc work maintain constraint exampl introduc strong spring forc enforc distanc mass point rigid bodi difficulti thi approach constraint satisfi exactli strong forc requir veri short timestep simul ineffici comput third approach method lagrang multipli project constraint manifold determin coordin adjust necessari satisfi constraint final variou hybrid approach differ set constraint satisfi differ method eg intern coordin explicit forc implicitforc solut intern coordin method simplest approach satisfi constraint energi minim molecular dynam repres mechan system socal intern coordin correspond unconstrain independ degre freedom system exampl dihedr angl protein independ set coordin specifi posit atom requir ani constraint difficulti internalcoordin approach twofold newtonian equat motion becom complex intern coordin difficult defin cyclic system constraint eg ring pucker protein ha disulfid bond origin method effici recurs energi minim intern coordin develop g cowork effici recurs internalcoordin constraint solver extend molecular dynam analog method appli system lagrang multiplierbas method molecular dynam simul constraint enforc method lagrang multipli set linear holonom constraint time sigma_k mathbf x_ kalpha mathbf x_ kbeta quad dot scriptstyl mathbf x_ ialpha scriptstylemathbf x_ ibeta posit particl involv constraint time d_k prescrib interparticl distanc constraint equat ad potenti energi function equat motion result particl system frac mathbf x_i partial m_i frac partial partial mathbf x_i left mathbf x_i sum_ lambda_k sigma_k right quad dot ad constraint equat potenti doe chang sinc sigma_k ideal integr side equat motion time yield constrain particl posit time delta mathbf delta _i hat mathbf delta _i sum_ lambda_k frac partialsigma_k partial mathbf x_i left delta tright quad dot hat mathbf delta _i unconstrain uncorrect posit particl integr unconstrain equat motion satisfi constraint sigma_k delta timestep lagrang multipli chosen sigma_k delta left mathbf x_ kalpha tdelta mathbf x_ kbeta tdelta thi impli solv system nonlinear equat sigma_j delta left hat mathbf jalpha tdelta hat mathbf jbeta tdelta sum_ lambda_k left frac partialsigma_k partial mathbf x_ jalpha m_ jalpha frac partialsigma_k partial mathbf x_ jbeta m_ jbeta right quad dot simultan unknown lagrang multipli lambda_k thi system nonlinear equat unknown best solv newton method solut vector underlin lambda updat underlin lambda leftarrow underlin lambda mathbf j_sigma underlin sigma mathbf j_sigma jacobian equat mathbf left begin array cccc frac frac dot frac partiallambda_n frac frac dot frac partiallambda_n vdot vdot ddot vdot frac partialsigma_n frac partialsigma_n dot frac partialsigma_n partiallambda_n end array right sinc particl involv constraint mathbf j_sigma blockwisediagon solv blockwis ie molecul molecul furthermor constantli updat vector underlin lambda iter start underlin lambda mathbf result simpler express sigma_k frac partial sigma_k partial lambda_j iter unconstrain particl posit updat hat mathbf _i tdelta leftarrow hat mathbf _i tdelta sum_ lambda_k frac partial sigma_k partial mathbf x_i vector reset underlin lambda mathbf thi repeat constraint equat sigma_k tdelta satisfi prescrib toler number algorithm comput lagrang multipli differ onli solv system equat usual quasinewton method settl algorithm settl algorithm solv system nonlinear equat analyt constraint constant time doe scale larger number constraint veri constrain rigid water molecul biolog simul usual model three constraint eg spce water model shake algorithm shake algorithm wa algorithm develop satisfi bond geometri constraint dure molecular dynam simul solv system nonlinear constraint equat gaussseidel method approxim solut linear system equat lambda mathbf j_sigma underlin sigma newton iter thi amount assum mathbf j_sigma diagon domin solv equat onli unknown practic comput lambda_k leftarrow frac sigma_k partial sigma_k partial lambda_k mathbf x_ kalpha leftarrow mathbf x_ kalpha lambda_k frac partial sigma_k partial mathbf x_ kalpha mathbf x_ kbeta leftarrow mathbf x_ kbeta lambda_k frac partial sigma_k partial mathbf x_ kbeta iter constraint equat sigma_k tdelta solv toler iter shake algorithm cost mathcal oper iter themselv converg linearli nonit form shake wa develop sever variant shake algorithm exist differ comput appli constraint themselv constraint model lagrang multipli comput gaussseidel method origin shake algorithm limit mechan system tree structur ie close loop constraint extens method qshake quaternion shake wa develop amend thi work satisfactorili rigid loop aromat ring system fail flexibl loop protein ha disulfid bond extens includ rattl wiggl mshake rattl work shake veloc verlet time integr scheme wiggl extend shake rattl initi estim lagrang multipli lambda_k base particl veloc final mshake comput correct constraint forc achiev better converg final modif pshake algorithm rigid semirigid molecul pshake comput updat precondition appli constraint gradient befor shake iter caus jacobian mathbf j_sigma becom diagon strongli diagon domin thu decoupl constraint converg faster quadrat oppos linearli cost mathcal mshake algorithm mshake algorithm solv nonlinear system equat newton method directli iter linear system equat underlin lambda leftarrow mathbf j_sigma underlin sigma solv exactli lu decomposit iter cost mathcal oper solut converg quadrat requir fewer iter shake thi solut wa propos ciccotti ryckaert titl matrix method differ solut linear system equat ciccotti ryckaert invert matrix mathbf j_sigma directli onli onc fist iter iter cost mathcal oper wherea follow iter cost onli mathcal oper matrixvector multipl thi improv cost sinc jacobian longer updat converg onli linear albeit faster rate shake algorithm linc algorithm altern constraint method linc linear constraint solver wa develop wa base earlier method eem modif linc ha report time faster shake linc appli lagrang multipli constraint forc solv multipli seri expans approxim invers jacobian mathbf j_sigma mathbf mathbf j_sigma mathbf mathbf j_sigma mathbf mathbf dot step newton iter invers onli work matric eigenvalu smaller algorithm suitabl onli molecul low connect hybrid method hybrid method introduc constraint divid group constraint group solv intern coordin wherea second group solv constraint forc eg lagrang multipli project method thi approach wa pioneer lagrang result lagrang equat mix type molecular dynam softwar molecular mechan model refer footnot laplac ps mcaniqu analytiqu noguti g method rapid calcul deriv matrix conform energi larg molecul journal physic societi japan doi abe braun noguti g rapid calcul deriv conform energi respect dihedr angl protein gener recurr equat comput chemistri doi bae haug ej recurs formul constrain mechan system dynam open loop system mechan structur machin jain vaidehi rodriguez fast recurs algorithm molecular dynam simul journal comput physic rice lm brnger torsion angl dynam reduc variabl conform sampl enhanc crystallograph structur refin protein structur function genet doi mathiowetz jain karasawa goddard iii wa protein simul techniqu suitabl veri larg system cell multipol method nonbond interact newtoneul invers mass oper method intern coordin dynam protein structur function genet doi mazur ak quasihamiltonian equat motion intern coordin molecular dynam polym journal comput chemistri doi sici gt miyamoto kollman pa settl analyt version shake rattl algorithm rigid water model journal comput chemistri doi ryckaert jp ciccotti berendsen hjc numer integr cartesian equat motion system constraint molecular dynam nalkan journal comput physic doi yoneya berendsen hjc hirasawa nonit matrix method constraint moleculardynam simul molecular simul doi forest tr smith shake rattl roll effici constraint algorithm link rigid bodi journal comput chemistri doi sici gt mcbride wilson howard jak molecular dynam simul liquid crystal phase atomist potenti molecular physic doi andersen han rattl veloc version shake algorithm molecular dynam calcul journal comput physic doi lee sangho kim palmo samuel krimm wiggl constrain molecular dynam algorithm cartesian coordin journal comput physic doi gonnet pedro pshake quadrat converg shake mathcal journal comput physic doi lambrako bori oran chandrasekhar nagumo modifi shake algorithm maintain rigid bond molecular dynam simul larg molecul journal comput physic doi ciccotti ryckaert molecular dynam simul rigid molecul comput physic report doi krutler vincent van gunsteren hnenberg fast shake algorithm solv distanc constraint equat small molecul molecular dynam simul journal comput chemistri doi gt edberg evan dj morriss gp constrain moleculardynam simul liquid alkan algorithm journal chemic physic doi hess bekker berendsen hjc fraaij jgem linc linear constraint solver molecular simul journal comput chemistri doi sici gt mazur ak symplect integr close chain rigid bodi dynam intern coordin equat motion journal chemic physic doi baranyai evan dj algorithm constrain moleculardynam simul liquid benzen naphthalen molecular physic doi rodriguez jain kreutzdelgado spatial oper algebra manipul model control intern journal robot doi bae haug ej recurs formul constrain mechan system dynam ii close loop system mechan structur machin sommerfeld arnold lectur theoret physic mechan york academ press