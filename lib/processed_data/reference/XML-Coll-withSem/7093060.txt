ziggurat algorithm neojay pseudorandom number gener ziggurat algorithm algorithm gener random number non uniform distribut belong class reject sampl algorithm choos valu monoton decreas probabl distribut appli symmetr unimod distribut normal distribut choos point half randomli choos half wa develop georg marsaglia wai wan tsang algorithm assum underli sourc uniformlydistribut random number typic pseudorandom number gener common case time normal exponenti distribut typic tabl size algorithm consist gener random floatingpoint valu random tabl perform tabl lookup multipli comparison thi consider faster commonli method gener normal distribut random number marsaglia polar method boxmul transform requir logarithm squar root hand ziggurat algorithm complex implement requir precomput tabl best larg quantiti random number requir ziggurat algorithm becaus cover probabl distribut rectangular segment stack decreas size order resembl ziggurat ziggurat algorithm gener sampl valu normal distribut onli posit valu simplic pink dot initi uniformdistribut random number desir distribut function segment equal area layer select random uniform sourc left random valu top sourc multipl width chosen layer result test region slice fall possibl outcom left solid black region sampl clearli curv pass directli output vertic stripe region sampl valu lie curv test case random valu chosen layer gener compar point curv valu output third case chosen point reject algorithm restart theori oper ziggurat algorithm reject sampl algorithm randomli gener point distribut slightli larger desir distribut test gener point insid desir distribut tri random point underneath probabl distribut curv coordin random number desir distribut distribut ziggurat algorithm choos equalarea region rectangl cover bulk desir distribut top nonrectangular base includ tail distribut monoton decreas probabl distribut function defin base ziggurat defin point insid distribut thi consist rectangular region typic infinit tail distribut gt thi layer ha area top thi add rectangular layer width height ha area top thi layer height intersect distribut function point thi layer includ everi point distibut function unlik base layer includ point desir distribut layer stack top precomput tabl size typic choos xn top box box reach distribut peak exactli layer extend vertic yi yi divid region horizont gener larger portion xi entir desir distribut small portion xi xi onli partial ignor moment problem layer uniform random variabl ziggurat algorithm describ choos random layer return comput return otherwis choos random number step step amount choos lowresolut coordin step test coordin clearli desir distribut function coordin step choos highresolut coordin step doe reject test close space layer algorithm termin step veri larg fraction time note top layer howev thi test alway fail becaus layer divid central region edg edg infinit tail algorithm check point central region gener fictiti thi will gener point correct frequenc rare case layer select special fallback algorithm select point random tail becaus fallback algorithm time speed essenti thu full ziggurat algorithm onesid distribut choos random layer return gener point tail fallback algorithm comput return otherwis choos random number step twosid distribut cours result negat time thi conveni choos step test fallback algorithm tail becaus ziggurat algorithm onli gener output veri rapidli requir fallback algorithm outlier alway complex direct implement fallback algorithm cours depend distribut exponenti distribut tail bodi distribut fall elementari algorithm ln ln anoth call ziggurat algorithm recursionrecurs normal distribut marsaglia compact algorithm ln ln gt x return otherwis step sinc typic tabl size test step alway success note ln simpl gener exponenti distribut random number ziggurat exponenti distribut gener avail optimizations algorithm perform effici precomput tabl modif faster noth ziggurat algorithm depend probabl distribut function normal integr curv equal remov normal constant speed comput uniform random number gener base integ random number gener return integ rang tabl number directli comput twosid distribut twosid describ earlier random integ interpret sign number rang scale factor compar result multipl step possibl precomput xi xi compar directli integ random number gener limit premultipli appropri integ comparison abov chang tabl unmodifi xi valu longer delet gener ieee singleprecis float point valu onli mantissa includ implicit lead leastsignific bit integ random number bit select layer number refer detail discuss thi three step inlin function call outoflin implement frequent step gener tabl possibl store entir tabl precomput includ valu implement thinsp sourc code comput remain valu initi random number gener previous describ find xi thinsp yi yi xi repeat time layer ziggurat yn will cours roundoff error saniti test accept small actual fill tabl valu assum xn yn accept slight differ layer area round error find initi guess comput area tail gt exponenti distribut thi normal distribut assum unnorm thi erfc awkward distribut numer integr requir thi hand find area tail area base layer comput seri yi xi abov yi gt ani initi estim wa low lead larg area yn initi estim wa high thi rootfind algorithm bisect method find valu produc yn close possibl altern valu area topmost layer xn yn close desir valu possibl thi save evalu thinsp actual condit greatest interest boxmul transform random number gener refer georg marsaglia wai wan tsang ziggurat method gener random variabl journal statist softwar retriev note thi paper number layer start top layer bottom special case explan abov number layer bottom implement ziggurat method normal densiti function exponenti densiti function essenti copi code paper jurgen doornik improv ziggurat method gener normal random sampl nuffield colleg oxford retriev describ hazard leastsignific bit integ random number gener choos layer number ziggurat algorithm gener normal distribut random number describ ziggurat algorithm introduc matlab version david thoma philip gw leong wayn luk john villasenor gaussian random number gener acm comput survey appear retriev test mani algorithm gener normal aka gaussian random number conclud maintain extrem high nois qualiti prioriti subject constraint speed desir ziggurat method will appropri choic