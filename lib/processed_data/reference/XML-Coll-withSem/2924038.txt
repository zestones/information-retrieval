ioctl philip cross cleanup unix cleanup novemb comput ioctl pronounc iocontrol user to kernel interfac convent oper system short inputoutput control ioctl typic employ allow userspac code commun hardwar devic kernel compon background convent oper system divid layer userspac kernel applic code text editor resid userspac underli facil oper system network stack resid kernel kernel code handl sensit resourc implement secur reliabl barrier applic thi reason user mode applic prevent cpu directli access kernel resourc userspac applic request convent kernel system call special subroutin call transit oper system user mode kernel mode thi usual implement system call vector requestor indic desir system call number instanc exit system call write system call system call vector kernel function handl request thi convent oper system typic provid sever hundr system call expedi design system call thi challeng devic driver necess hardwar peripher directli address onli kernel user code commun devic instanc administr configur media type ethernet interfac modern oper system support divers devic mani offer complex uservis interfac oper system vendor difficult provid devic api hardcod system call number ioctl interfac skirt thi problem alloc singl system call share devic driver thi system call specif request variou devic vector typic handl devic request number kernel thu dynam dispatch call devic creat unmanag hardcod system call tabl termin ioctl expos endus applic termin io unix oper system tradit heavi command interfac unix command interfac built pseudo termin pti emul hardwar text termin pti control configur hardwar devic ioctl call instanc window size pti set tiocswinsz ioctl hardwar devic configur common ioctl control hardwar devic exampl system ioctl call commun usb devic discov drive geometri inform attach storag devic ioctl unix system configur network interfac exampl bsd unix system mac os ip subnet mask interfac configur open network socket invok siocsifnetmask ioctl kernel extens applic extend kernel instanc acceler network process ioctl call provid conveni bridg userspac code kernel extens kernel extens provid locat filesystem open arbitrari number ioctl call dispatch allow extens program ad system call oper system exampl solari oper system ipfilt packet firewal program siocipf ioctl call implement unix unix ioctl call paramet open file descriptor request code number integ valu possibl unsign driver pointer data driver kernel gener dispatch ioctl straight devic driver interpret request number data whatev requir writer driver document request number driver provid constant header file unix system convent encod request number size data transfer tofrom devic driver direct data transfer ident driver implement request convent follow kernel driver collabor deliv uniform error code denot symbol constant enotti applic request driver doe recognis mnemon enotti tradit associ textual messag typewrit deriv fact earliest system incorpor ioctl call onli teletyp tti devic rais thi error symbol mnemon compat requir modern system help render gener messag inappropri devic control oper localis tcset exemplifi ioctl serial port normal read write call serial port receiv send data byte ioctl fd tcset data call separ normal io control variou driver option handl special charact output signal port dtr signal deviceiocontrol paramet open object handl equival file descriptor request code number control code buffer input paramet length input buffer buffer output result length output buffer overlap structur overlap io devic control code consider mode oper perform defin mode oper impact secur devic driver method_in_direct buffer address verifi readabl user mode caller method_out_direct buffer address verifi writabl user mode caller method_neith user mode virtual address pass driver map valid method_buff io manag control share buffer move data user mode altern vector call interfac devic kernel extens link userspac addit system call thi approach rare becaus oper system develop tri system call interfac focus effici unix oper system vector call interfac popular fcntl file control system call configur open file situat enabl nonblock io setsockopt set socket option system call configur open network socket facil configur ipfw packet firewal bsd unix system memori map unix devic interfac inputoutput capabl sometim provid memorymap file applic interact devic open locat filesystem correspond devic ioctl call memori map system call tie portion address space kernel thi interfac effici provid bulk data transfer devic userspac applic individu ioctl readwrit system call inflict overhead repeat userspacetokernel transit access memorymap rang address incur overhead platform buffer io method file map object howev simpl devic driver standard deviceiocontrol method_ access suffici implic complex ioctl call minim complex kernel system call interfac howev provid place develop stash bit piec kernel program interfac ioctl complic overal usertokernel api kernel provid sever hundr system call provid sever ioctl call interfac ioctl call appear differ convent system call practic littl differ ioctl system call ioctl simpli system call differ dispatch mechan mani argument expand kernel system call interfac therefor appli ioctl interfac applic develop system call appear differ applic subroutin simpli function call argument return valu runtim librari os mask complex involv invok system call unfortun runtim librari ioctl call transpar simpl oper discov ip address es machin requir tangl mess ioctl call requir magic number argument structur libpcap libdnet exampl thirdparti wrapper unix librari design mask complex ioctl interfac packet captur packet io respect secur usertokernel interfac mainstream oper system audit heavili code flaw secur vulner prior releas audit typic focu welldocu system call interfac instanc auditor ensur sensit secur call chang user onli avail administr user ioctl interfac complic divers thu harder audit system call furthermor becaus ioctl provid thirdparti develop core oper system ha releas ioctl call implement receiv scrutini thu harbor vulner final mani ioctl call particularli thirdparti devic driver undocu becaus handler ioctl call resid directli kernel mode input userspac valid care vulner devic driver exploit local user pass invalid buffer ioctl call unix oper system protect userspac devic access applic specif access control appli devic secur problem aris devic driver develop appli appropri access control userspac access object modern oper system protect kernel hostil userspac code applic infect buffer overflow exploit system call wrapper system call wrapper implement rolebas access control specifi system call invok applic wrapper instanc revok mail program spawn program ioctl interfac complic system call wrapper becaus larg number differ argument requir normal program refer msdn deviceiocontrol document amboxstyl style thi requir meet wikipedia pleas improv thi articl novemb ioctl linux man ioctl_list linux man ioctl freebsd system call manual