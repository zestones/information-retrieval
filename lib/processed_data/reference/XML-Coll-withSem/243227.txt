tarjan offlin common ancestor algorithm giftlit graph algorithm comput scienc tarjan offlin common ancestor algorithm algorithm comput lowest common ancestor pair node tree base unionfind data structur common ancestor node root tree node ancestor ha greatest depth robert tarjan discov techniqu tarjan algorithm offlin unlik lowest common ancestor algorithm requir pair node lowest common ancestor desir specifi advanc simplest version algorithm union find data structur unlik lowest common ancestor data structur constant time oper number pair node magnitud number node refin gabow tarjan speed algorithm linear time pseudocod pseudocod determin common ancestor pair root tree children node set nchildren thi offlin algorithm set specifi advanc makeset find union function disjointset forest makeset remov singleton set find return standard repres set union merg set set tarjanolca call root function tarjanolca makeset uancestor uchildren tarjanolca union find ancestor ucolour black vcolour black print tarjan common ancestor find ancestor node initi white color black children visit common ancestor pair avail find ancestor immedi onli immedi color black provid alreadi black otherwis will avail find ancestor immedi color black refer optim version makeset find union disjointset forest function makeset xparent xrank function union xroot find yroot find xrootrank gt yrootrank yrootpar xroot els xrootrank yrootrank xrootpar yroot els xroot yroot yrootpar xroot xrootrank xrootrank function find xparent return els xparent find xparent return xparent refer gabow tarjan lineartim algorithm special case disjoint set union proceed acm symposium theori comput stoc doi tarjan applic path compress balanc tree journal acm doi