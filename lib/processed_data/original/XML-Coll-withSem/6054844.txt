call gate tz thijsbot secur exploit architectur call gate callgat mechan intel architectur chang privileg level cpu execut predefin function call call instruct overview call gate intend allow privileg code call code higher privileg level type mechan essenti modern oper system employ memori protect allow user applic kernel function system call control oper system call gate special selector refer descriptor access global descriptor tabl local descriptor tabl need call privileg boundari mechan interrupt gate secur issu preserv system secur global descriptor tabl held protect memori program will creat call gate rais privileg level call gate vector softwar secur exploit way protect exampl email worm guronga written exploit microsoft window oper system devicephysicalmemori instal call gate assum call gate set oper system kernel code simpli call lcall syntax segment selector offset field ignor processor will perform number check entri valid code oper suffici privileg gate assum check pass cs eip load segment descriptor continu push stack privileg level ss esp cs eip order paramet copi stack stack need number paramet copi locat call gate descriptor kernel return user space program ret lret instruct pop continu stack return outer privileg level exact format call gate descriptor ia manual modern modern oper system transit call callgat introduct sysentersysexit syscallsysret faster mechan introduc control transfer program architectur support call gate rare instruct softwar interruptstrap prefer portabl call gate flexibl sysentersysexit syscallsysret instruct call gate allow chang arbitrari privileg level arbitrari privileg level fast sy instruct allow control transfer ring gt vice versa compar call gate interrupt call gate faster comput insecur softwar interrupt interrupt gate system call syscal instruct global descriptor tabl extern link callgat execut privileg code fsecur viru guronga