tarjan offlin common ancestor algorithm tz giftlit graph algorithm comput scienc tarjan offlin common ancestor algorithm algorithm comput lowest common ancestor pair node tree base unionfind data structur common ancestor node root tree node ancestor greatest depth name robert tarjan discov techniqu tarjan algorithm offlin lowest common ancestor algorithm requir pair node lowest common ancestor desir advanc simplest version algorithm union find data structur lowest common ancestor data structur constant time oper number pair node magnitud number node refin gabow tarjan speed algorithm linear time pseudocod pseudocod determin common ancestor pair root tree children node set nchildren offlin algorithm set advanc makeset find union function disjointset forest makesetu remov singleton set findu return standard repres set unionuv merg set set tarjanolcar call root function tarjanolcau makesetu uancestor uchildren tarjanolcav unionuv finduancestor ucolour black uv vcolour black print tarjan common ancestor findvancestor node initi white color black children visit common ancestor pair uv findvancestor color black provid black will finduancestor color black refer optim version makeset find union disjointset forest function makesetx xparent xrank function unionx xroot findx yroot findi xrootrank gt yrootrank yrootpar xroot xrootrank yrootrank xrootpar yroot xroot yroot yrootpar xroot xrootrank xrootrank function findx xparent return xparent findxpar return xparent refer gabow tarjan lineartim algorithm special case disjoint set union proceed acm symposium theori comput stoc doi tarjan applic path compress balanc tree journal acm doi