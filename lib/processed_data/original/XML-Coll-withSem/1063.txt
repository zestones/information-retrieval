algorithm calcul varianc tz lese statist algorithm statist deviat dispers articl exampl pseudocod algorithm calcul varianc play major role statist comput key problem design good algorithm problem formula varianc involv sum squar lead numer instabl well arithmet overflow deal larg valu nave algorithm formula calcul varianc entir popul size sigma displaystylefrac sum_in x_i sum_in x_inn formula calcul unbias estim popul varianc finit sampl observ displaystylefrac sum_in x_i sum_in x_inn naiv algorithm calcul estim varianc pseudocod sum sum_sqr foreach data sum sum sum_sqr sum_sqr xx sumn varianc sum_sqr summeann algorithm easili adapt comput varianc finit popul simpli divid minu sum_sqr sum number precis result inher precis floatingpoint arithmet perform comput bad varianc small rel sum number ii twopass algorithm altern approach formula varianc pseudocod sum foreach data sum sum sumn sum foreach data sum sum varianc sumn algorithm numer reliabl nave algorithm larg set data wors data close precis equal simpl algorithm ii depend inordin order data poor larg data set repeat roundoff error accumul sum techniqu compens summat combat error degre iia compens variant compensatedsumm version algorithm read sum foreach data sum sum sumn sum sumc foreach data sum sum sumc sumc varianc sum sumcnn iii onlin algorithm comput varianc singl pass inspect x_i exampl data collect storag valu cost memori access domin comput onlin algorithm recurr relat requir quantiti requir statist calcul numer stabl fashion formula updat estim varianc sequenc addit element x_mathrmnew denot estim popul meanus sampl sn estim popul varianc sn estim sampl varianc number element sequenc addit m_mathrmnew fracn m_mathrmold x_mathrmnewn m_mathrmold fracx_mathrmnew m_mathrmoldn s_mathrmn fracn s_mathrmn x_mathrmnew m_mathrmnew x_mathrmnew m_mathrmoldn mathrmn gt s_mathrmn fracn s_mathrmn x_mathrmnew m_mathrmnew x_mathrmnew m_mathrmoldn turn suitabl quantiti updat sum squar differ current sum_in x_i denot m_ m_mathrmnew m_mathrmold x_mathrmnew m_mathrmoldx_mathrmnew m_mathrmnew s_mathrmn fracm_n s_mathrmn fracm_n numer stabl algorithm comput algorithm knuth cite welford foreach data delta deltan deltax express variance_n mn varianc mn algorithm prone loss precis massiv cancel effici divis oper insid loop robust twopass algorithm comput varianc comput subtract estim algorithm residu conveni form allow calcul standard deviat explicitli calcul number element sequenc addit element s_mathrmn fracns_mathrmn oldfracnnleftx_textnewm_textoldrightn iv weight increment algorithm observ weight west suggest increment algorithm foreach data sumweight weight temp weight sumweight sumweightweightxmean temp xmeanweight temp sumweight temp varianc sumweight sampl popul omit nn parallel algorithm chan al note onlin algorithm iii special case algorithm work partit sampl set xa xb delta mb ma mx ma deltacdotfracnbnx m_x m_a m_b deltacdotfracna nbnx exampl multipl process unit assign discret part input higherord statist terriberri extend chan formula calcul third fourth central moment need exampl estim skew kurtosi m_x m_a m_b deltafracna nb nbnx deltafracnam_b nbm_anx beginalign m_x m_a m_b deltafracna nb leftna nb nbrightnx deltafracna m_b nb m_anx deltafracnam_b nbm_anx endalign m_k sum power differ sigmax overlinexk skew g_ fracsqrtn m_m_ kurtosi g_ fracn m_m_ increment case simplifi delta fracdeltan m_ m_ delta frac nn m_ m_ delta frac fracdelta m_n m_ m_ fracdelta fracdelta m_n fracdelta m_n preserv delta divis oper need higherord statist calcul increment cost exampl assum float point oper standard ieee doubleprecis arithmet consid sampl infinit popul base sampl estim popul unbias estim popul varianc algorithm algorithm ii comput valu correctli consid sampl rise estim varianc sampl algorithm ii comput varianc estim correctli algorithm return loss precis toler view minor flaw algorithm easi find data reveal major flaw naiv algorithm sampl estim popul varianc comput correctli algorithm ii naiv algorithm comput minu seriou problem algorithm varianc definit neg comput formula varianc refer donald knuth art comput program volum seminumer algorithm edn boston addisonwesley welford note method calcul correct sum squar product technometr west commun acm updat varianc estim improv method chan toni golub gene levequ randal updat formula pairwis algorithm comput sampl varianc technic report stanc depart comput scienc stanford univers terriberri timothi comput higherord moment onlin extern link eric weisstein sampl varianc comput mathworld