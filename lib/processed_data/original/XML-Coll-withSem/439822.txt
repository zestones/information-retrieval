prefetch input queue tz smackbot articl merg octob instruct process articl merg amboxmov style merg arrow suggest articl modern processor load instruct clock cycl execut achiev preload machin code memori prefetch input queue piq behavior appli von neumann comput harvard architectur comput selfmodifi code sort instruct pipelin comput fulfil three requir prefetch behavior piq invis program model cpu circumst behavior piq visibl account programm xprocessor chang mode realmod protect mode vice versa piq flush cpu will continu translat machin code written mode piq flush processor translat code wrong gener invalid instruct except execut selfmodifi code chang processor code front current locat execut chang processor interpret code load piq simpli execut copi load piq alter version code ram andor cach behavior piq determin code execut insid emul directli hardwar real cpu emul will simul behavior piqsiz chang code affect processor deduc code execut emul processor invalid piq write address load piq exampl code code_starts_her mov eax ahead mov eax ahead jmp to_the_end code to_the_end selfmodifi program will overwrit jmp to_the_end nop encod jump jmp to_the_end assembl byte machin code nop will overwrit jump jump replac donothingcod machin code jump read piq execut processor superscalar processor execut instruct pretend dont backward compat chang code will chang execut flow exampl program detect size piq exampl nasm syntax selfmodifi assembl algorithm determin size piq code_starts_her xor cx cx regist cx xor ax ax regist ax mov dx cs mov code_seg dx calcul codeseg jump edx cmp ax check ax alterd je found_siz mov nop_fieldcx opcod nop oper cx db xea xea opcod jump dw flush_queu offset rm dw pm dd code_seg dw code segment calcul flush_queu mov nop_fieldcx opcod ax increas ax nop_field nop time jmp found_siz regist cx size piq code real mode bit protect mode easili chang run bit protect mode well chang dw offset dd chang dx edx top well dw dx bit address dd edx bit address code basic chang execut flow determin brute forc larg piq chang code front affect piq updat will chang code will affect program program size processor piq code execut protect mode oper system context switch program return wrong instruct pipelin assembl languag cpu design