readcopyupd tz nealcardwel concurr control oper system technolog rcu redirect record label rcu record readcopyupd rcu oper system kernel technolog improv perform comput cpu technic synchron mechan altern readerswrit lock allow extrem low overhead waitfre read rcu updat expens leav version data structur place accommod preexist reader version reclaim preexist reader finish access rcu number task includ dynam chang nmi nonmask interrupt handler implement lazi barrier frequent replac readerwrit lock rcu number oper system includ version linux kernel techniqu cover softwar patent issu august assign sequent comput system well nowexpir patent cover close techniqu rcu topic claim sco ibm lawsuit overview basic idea rcu split updat remov reclam phase remov phase remov refer data item data structur replac refer version data item concurr reader reason safe remov phase concurr reader semant modern cpu guarante reader will version data structur partial updat refer reclam phase work reclaim free data item remov data structur remov phase reclaim data item disrupt reader concurr referenc data item reclam phase start reader longer hold refer data item split updat remov reclam phase allow updat perform remov phase defer reclam phase reader activ remov phase complet block finish regist callback invok finish reader activ remov phase consid reader start remov phase will unabl gain refer remov data item disrupt reclam phase typic rcu updat sequenc remov pointer data structur subsequ reader gain refer wait previou reader complet rcu readsid critic section point reader hold refer data structur safe reclaim freed kfree linux kernel step key idea underli rcu defer destruct abil wait reader allow rcu reader lighterweight synchron case absolut synchron contrast convent lockbas scheme reader heavyweight synchron order prevent updat delet data structur lockbas updat typic updat data item place exclud reader contrast rcubas updat typic advantag fact write singl align pointer atom modern cpu allow atom insert remov replac data item link structur disrupt reader concurr rcu reader continu access version dispens atom oper memori barrier cach miss expens modern smp comput system absenc lock content threestep procedur updat perform remov reclam step help entir thread reclam fact case linux kernel directoryentri cach dcach thread perform updat step step reclam step step help separ exampl rcu reader updat commun rcu implicit lowoverhead commun reader reclaim step exampl api implement rcu version linux kernel betterknown rcu implement will exampl rcu api remaind articl core linux kernel rcu api applic program interfac small rcu_read_lock rcu_read_unlock synchronize_rcu call_rcu rcu_assign_point rcu_derefer linux kernel numer rcurel api httpwwwrdropcomuserspaulmckrcuwhatisrcuhtml rcu_read_lock reader inform reclaim reader enter rcu readsid critic rcuprotect data structur access rcu readsid critic guarante remain unreclaim full durat critic scheme refer count conjunct rcu maintain longerterm refer data structur rcu_read_unlock reader inform reclaim reader exit rcu readsid critic note rcu readsid critic section nest andor overlap synchronize_rcu call_rcu mark updat code reclaim code block preexist rcu readsid critic section cpu complet note synchronize_rcu will wait subsequ rcu readsid critic section complet exampl consid sequenc event cpu cpu cpu rcu_read_lock enter synchronize_rcu rcu_read_lock rcu_read_unlock exit synchronize_rcu rcu_read_unlock reiter synchronize_rcu wait ongo rcu readsid critic section complet synchronize_rcu invok cours synchronize_rcu return preexist rcu readsid critic complet thing well schedul delay thing rcu implement process request batch order improv effici delay synchronize_rcu synchronize_rcu api figur reader implement key rcu rcu readintens situat synchronize_rcu overhead small call_rcu api callback form synchronize_rcu describ detail block regist function argument invok ongo rcu readsid critic section complet callback variant situat illeg block rcu_assign_point updat function assign rcuprotect pointer order safe commun chang updat reader function return execut memori barrier instruct requir cpu architectur importantli serv document pointer protect rcu rcu_derefer reader rcu_derefer fetch rcuprotect pointer return safe dereferenc note rcu_defer derefer pointer protect pointer dereferenc execut need memorybarri instruct cpu architectur current dec alpha memori barrier rcu_derefer cpu compil compil direct note return rcu_derefer valid enclos rcu readsid critic exampl legal rcu_read_lock rcu_dereferenceheadnext rcu_read_unlock gtaddress rcu_read_lock gtdata rcu_read_unlock hold refer rcu readsid critic illeg hold refer lockbas critic refer critic acquir illeg normal lock rcu_assign_point function rcu_derefer document pointer protect rcu relat rcu api diagram api commun reader updat reclaim rcu infrastructur observ time sequenc rcu_read_lock rcu_read_unlock synchronize_rcu call_rcu invoc order determin synchronize_rcu invoc return caller call_rcu callback invok effici implement rcu infrastructur heavi batch order amort overhead correspond api simpl implement rcu rcu extrem simpl toy implement aid understand rcu present toy implement classic rcu implement linux kernel note implement work nonpreempt environ void rcu_read_lockvoid void rcu_read_unlockvoid void synchronize_rcuvoid int cpu for_each_cpucpu run_oncpu ignor rcu_assign_point rcu_derefer miss dont forget submit linuxkernel patch rcu defin rcu_assign_pointerp smp_wmb defin rcu_dereferencep typeofp _________p smp_read_barrier_depend _________p note rcu_read_lock rcu_read_unlock absolut great strength classic rcu nonpreempt kernel readsid overhead precis nonalpha cpu absolut rcu_read_lock particip deadlock cycl realtim process schedul deadlin precipit prioriti invers result high lock content implement synchronize_rcu simpli schedul cpu turn guarante reader version data structur complet illeg block rcu readsid critic cpu execut context switch schedul process complet preced rcu readsid critic section cpu execut context switch preced rcu readsid critic section will complet exampl suppos remov data item structur invok synchronize_rcu synchronize_rcu return guarante rcu readsid critic section hold refer data item safe reclaim analog readerwrit lock rcu way common rcu analog readerwrit lock sidebysid code display close readerwrit lock left rcu struct el struct el struct list_head lp struct list_head lp long key long key spinlock_t mutex spinlock_t mutex int data int data data field data field define_rwlocklistmutex define_spinlocklistmutex list_headhead list_headhead int searchlong key int result int searchlong key int result struct el struct el read_lock listmutex rcu_read_lock list_for_each_entryp head lp list_for_each_entry_rcup head lp gtkey key gtkey key result gtdata result gtdata read_unlock listmutex rcu_read_unlock return return read_unlock listmutex rcu_read_unlock return return int deletelong key int deletelong key struct el struct el write_lock listmutex spin_lock listmutex list_for_each_entryp head lp list_for_each_entryp head lp gtkey key gtkey key list_del gtlp list_del_rcu gtlp write_unlock listmutex spin_unlock listmutex synchronize_rcu kfreep kfreep return return write_unlock listmutex spin_unlock listmutex return return differ approach small readsid lock move rcu_read_lock rcu_read_unlock updatesid lock move readerwrit lock simpl spinlock synchronize_rcu preced kfree potenti catch readsid updatesid critic section concurr case will problem check care exampl multipl independ list updat singl atom updat convert rcu will requir special care presenc synchronize_rcu rcu version delet block problem callbackbas mechan block call_rcu place synchronize_rcu call readcopi updat rcu updat link structur place thread wish step creat structur copi data structur save pointer structur modifi copi structur updat global pointer refer structur sleep oper system kernel determin reader left structur exampl linux kernel synchronize_rcu thread copi awaken kernel safe dealloc structur structur read concurr thread copi order updat readcopi updat abbrevi rcu contribut linux commun name techniqu includ passiv serial mp defer vmxa programm gener tornado programm histori techniqu mechan resembl rcu independ invent multipl time kung lehman describ garbag collector implement rculik access binari search tree septemb issu acm transact databas system udi manber richard ladner extend kung lehman work nongarbagecollect environ defer reclam thread run remov time termin work environ longliv thread publish technic report septemb issu acm transact databas system hennessi osisek seigh grant patent laps patent describ rculik mechan vmxa ibm mainfram william pugh describ rculik mechan reli explicit flagset reader technic report entitl concurr mainten skip list publish gregori adam describ chaotic relax book entitl concurr program principl practic chaotic relax numer linear algebra techniqu reduc synchron overhead cpu comput success approxim techniqu resembl rcu reader refer version data concurr slingwin mckenney receiv patent august describ rcu implement dynixptx linux kernel gamsa krieger appavoo stumm describ rculik mechan univers toronto tornado oper system close ibm oper system osdi paper sarma rcu version linux kernel octob number research includ van jacobson aju john richard rashid propos defer reclam fix period time approach hard real time softwar concurr control content deadlock lock softwar engin lockfre waitfre algorithm memori barrier mutual exclus nonblock synchron preemptiv multitask prioriti invers realtim comput starvat synchron extern link paul mckenney jonathan walpol rcu fundament rcu usag rcu rcu api linux weekli news paul mckenney rcu hart mckenney demk brown make lockless synchron fast perform implic memori reclam ipdp best paper compar rcu perform lockless synchron mechan journal version includ walpol author paul mckenney exploit defer destruct analysi readcopyupd techniqu oper system kernel dissert patent apparatu method achiev reduc overhead mutual exclus maintain coher multiprocessor system util execut histori thread monitor tom hart userapplicationlevel implement rcu perform microbenchmark infrastructur tom hart paul mckenney paul mckenney rcu linux kernel linux journal paul mckenney sleepabl rcu linux weekli news