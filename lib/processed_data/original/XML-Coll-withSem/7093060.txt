ziggurat algorithm tz neojay pseudorandom number gener ziggurat algorithm algorithm gener random number uniform distribut belong class reject sampl algorithm choos valu monoton decreas probabl distribut appli symmetr unimod distribut normal distribut choos point half randomli choos half develop georg marsaglia wai wan tsang algorithm assum underli sourc uniformlydistribut random number typic pseudorandom number gener common case time normal exponenti distribut typic tabl size algorithm consist gener random floatingpoint random tabl perform tabl lookup multipli comparison consider faster commonli method gener distribut random number marsaglia polar method boxmul transform requir logarithm squar root hand ziggurat algorithm complex implement requir precomput tabl best larg quantiti random number requir ziggurat algorithm name cover probabl distribut rectangular segment stack decreas size order resembl ziggurat ziggurat algorithm gener sampl valu normal distribut posit valu simplic pink dot initi uniformdistribut random number desir distribut function segment equal area layer select random uniform sourc left random top sourc multipl width chosen layer result test region slice fall outcom left solid black region sampl clearli curv pass directli output vertic stripe region sampl lie curv test case random chosen layer gener compar fx point curv output third case chosen point reject algorithm restart theori oper ziggurat algorithm reject sampl algorithm randomli gener point distribut larger desir distribut test gener point insid desir distribut random point underneath probabl distribut curv coordin random number desir distribut distribut ziggurat algorithm choos equalarea region rectangl cover bulk desir distribut top nonrectangular base includ tail distribut monoton decreas probabl distribut function fx defin base ziggurat defin point insid distribut fx consist rectangular region typic infinit tail distribut gt layer area top add rectangular layer width height ax area top layer height ax intersect distribut function point fx layer includ point distibut function base layer includ point desir distribut layer stack top precomput tabl size typic choos xn mean top box box reach distribut peak exactli layer extend vertic yi yi divid region horizont gener larger portion xi entir contain desir distribut small portion xi xi partial contain ignor moment problem layer uniform random variabl ziggurat algorithm describ choos random layer uxi xi return yi uyiyi comput fx fx return choos random number step step amount choos lowresolut coordin step test coordin clearli desir distribut function know coordin step choos highresolut coordin step reject test close space layer algorithm termin step larg fraction time note top layer test fail xn layer divid central region edg edg infinit tail algorithm check point central region gener fictiti ay will gener point correct frequenc rare case layer select special fallback algorithm select point random tail fallback algorithm time speed essenti full ziggurat algorithm onesid distribut choos random layer uxi xi return gener point tail fallback algorithm yi uyiyi comput fx fx return choos random number step twosid distribut cours result negat time conveni choos step test xi fallback algorithm tail ziggurat algorithm gener output rapidli requir fallback algorithm outlier complex direct implement fallback algorithm cours depend distribut exponenti distribut tail bodi distribut fall elementari algorithm elnu xxlnu call ziggurat algorithm recursionrecurs normal distribut marsaglia suggest compact algorithm lnux lnu gt return xx step typic tabl size test step success note lnu simpl gener exponenti distribut random number ziggurat exponenti distribut gener optim algorithm perform effici precomput tabl xi yi fxi modif faster ziggurat algorithm depend probabl distribut function normal integr curv equal remov normal constant speed comput fx uniform random number gener base integ random number gener return integ rang tabl xi number directli comput twosid distribut twosid describ earlier random integ interpret sign number rang scale factor compar result multipl step precomput xixi compar directli integ random number gener limit premultipli appropri integ comparison chang tabl unmodifi xi valu longer need delet gener ieee singleprecis float point valu bit mantissa includ implicit lead leastsignific bit bit integ random number bit select layer number refer detail discuss three step inlin function call outoflin implement frequent need step gener tabl store entir tabl precomput includ valu implement thinspx sourc code comput remain valu initi random number gener describ find xi thinspyi yi yiaxi repeat time layer ziggurat ynf will cours roundoff error saniti test accept small fill tabl valu assum xn ynf accept slight differ layer ns area round error find initi guess comput area tail gtx exponenti distribut normal distribut assum unnorm fx erfcx awkward distribut numer integr requir hand find fx area tail area base layer xy comput seri yi xi yi gt initi estim low lead larg area yn initi estim high rootfind algorithm bisect method find produc yn close altern area topmost layer xnfyn close desir save evalu thinspx condit greatest interest boxmul transform random number gener refer georg marsaglia wai wan tsang ziggurat method gener random variabl journal statist softwar retriev note paper number layer start top layer bottom special case explan number layer bottom implement ziggurat method normal densiti function exponenti densiti function essenti copi code paper jurgen doornik improv ziggurat method gener normal random sampl nuffield colleg oxford retriev describ hazard leastsignific bit integ random number gener choos layer number ziggurat algorithm gener distribut random number describ ziggurat algorithm introduc matlab version david thoma philip gw leong wayn luk john villasenor gaussian random number gener acm comput survey appear retriev test algorithm gener normal aka gaussian random number conclud maintain extrem high nois qualiti prioriti subject constraint speed desir ziggurat method will appropri choic