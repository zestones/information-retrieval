test testandset tz zoonfaf concurr control comput arithmet comput scienc testandset cpu instruct implement mutual exclus multiprocessor environ correct lock implement testandset lead memori content busi lock caus bu lock cach invalid testandset oper access memori atom lower overhead elabor lock protocol test testandset main idea spin testandset increas likelihood success testandset entri protocol lock boolean lock fals share lock variabl procedur entercrit lock true skip spin lock free testandsetlock actual atom lock exit protocol procedur exitcrit lock fals entri protocol normal memori read spin wait lock free testandset lock normal memori read free expens atom memori oper simpl spin testandset program languag support shortcircuit evalu entri protocol implement procedur entercrit lock true testandsetlock true skip spin lock caveat optim system program avoid high level concurr program exampl bad usag idiom doublecheck lock list antipattern parallel processor parallel program mutual exclus testandset refer gregori andrew foundat multithread parallel distribut program addisonwesley isbn