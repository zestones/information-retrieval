constraint algorithm tz jits niesen comput physic molecular physic numer differenti equat molecular dynam comput chemistri mechan constraint algorithm method satisfi constraint bodi obey newton equat motion three basic approach satisfi constraint choos novel unconstrain coordin intern coordin introduc explicit constraint forc minim constraint forc implicitli techniqu lagrang multipli project method constraint algorithm appli molecular dynam simul simul carri intern coordin automat satisfi bondlength bondangl constraint carri explicit implicit constraint forc bond length bond angl explicit constraint forc typic shorten timestep make simul effici comput comput power requir comput trajectori length intern coordin implicitforc constraint solver gener prefer mathemat background motion set particl describ set secondord ordinari differenti equat newton second law written matrix form mathbfm cdot fracdmathbfqdt mathbff fracparti vpartial mathbfq mass matrix vector gener coordin describ particl posit exampl vector cartesian coordin particl posit rk run absenc constraint nxn diagon squar matrix particl mass vector repres gener forc scalar vq repres potenti energi function gener coordin constraint coordin satisfi timeindepend algebra equat g_jmathbfq run breviti function gi group mdimension vector task solv combin set differentialalgebra dae equat ordinari differenti equat ode newton second law problem studi detail joseph loui lagrang laid method solv simplest approach defin gener coordin unconstrain approach elimin algebra equat reduc problem solv ordinari differenti equat approach exampl describ motion rigid bodi posit orient rigid bodi describ independ unconstrain coordin describ posit particl constraint maintain rel distanc drawback approach equat unwieldi complex exampl mass matrix nondiagon depend gener coordin second approach introduc explicit forc work maintain constraint exampl introduc strong spring forc enforc distanc mass point rigid bodi difficulti approach constraint satisfi exactli strong forc requir short timestep make simul ineffici comput third approach method lagrang multipli project constraint manifold determin coordin adjust satisfi constraint final hybrid approach set constraint satisfi method intern coordin explicit forc implicitforc solut intern coordin method simplest approach satisfi constraint energi minim molecular dynam repres mechan system socal intern coordin correspond unconstrain independ degre freedom system exampl dihedr angl protein independ set coordin posit atom requir constraint difficulti internalcoordin approach twofold newtonian equat motion complex intern coordin difficult defin cyclic system constraint ring pucker protein disulfid bond origin method effici recurs energi minim intern coordin develop cowork effici recurs internalcoordin constraint solver extend molecular dynam analog method appli system lagrang multiplierbas method molecular dynam simul constraint enforc method lagrang multipli set linear holonom constraint time sigma_kt mathbf x_kalphat mathbf x_kbetat d_k quad dot scriptstyl mathbf x_ialphat scriptstylemathbf x_ibetat posit particl involv kth constraint time d_k prescrib interparticl distanc constraint equat potenti energi function equat motion particl system fracparti mathbf x_itparti m_i fracpartialparti mathbf x_i left vmathbf x_it sum_kn lambda_k sigma_kt quad dot ad constraint equat potenti chang sigma_kt ideal integr side equat motion time yield constrain particl posit time delta mathbf xt delta t_i hatmathbf xt delta t_i sum_kn lambda_k fracpartialsigma_ktparti mathbf x_ileftdelta trightm_i quad dot hatmathbf xt delta t_i unconstrain uncorrect posit ith particl integr unconstrain equat motion satisfi constraint sigma_kt delta timestep lagrang multipli chosen sigma_kt delta left mathbf x_kalphatdelta mathbf x_kbetatdelta tright_ d_k impli solv system nonlinear equat sigma_jt delta left hatmathbf x_jalphatdelta hatmathbf x_jbetatdelta sum_kn lambda_k left fracpartialsigma_ktparti mathbf x_jalpham_jalpha fracpartialsigma_ktparti mathbf x_jbetam_jbetaright right_ d_k quad dot simultan unknown lagrang multipli lambda_k system nonlinear equat unknown best solv newton method solut vector underlinelambda updat underlinelambd leftarrow underlinelambd mathbf j_sigma underlinesigma mathbf j_sigma jacobian equat mathbf left beginarraycccc fracpartialsigma_partiallambda_ fracpartialsigma_partiallambda_ dot fracpartialsigma_partiallambda_n fracpartialsigma_partiallambda_ fracpartialsigma_partiallambda_ dot fracpartialsigma_partiallambda_n vdot vdot ddot vdot fracpartialsigma_npartiallambda_ fracpartialsigma_npartiallambda_ dot fracpartialsigma_npartiallambda_n endarrayright particl involv constraint mathbf j_sigma blockwisediagon solv blockwis molecul molecul constantli updat vector underlinelambda iter start underlinelambda mathbf simpler express sigma_kt fracparti sigma_ktparti lambda_j iter unconstrain particl posit updat hatmathbf x_itdelta leftarrow hatmathbf x_itdelta sum_kn lambda_klfracparti sigma_kparti mathbf x_i vector reset underlinelambd mathbf repeat constraint equat sigma_ktdelta satisfi prescrib toler number algorithm comput lagrang multipli differ solv system equat quasinewton method settl algorithm settl algorithm solv system nonlinear equat analyt constraint constant time scale larger number constraint constrain rigid water molecul biolog simul model three constraint spce tipp water model shake algorithm shake algorithm algorithm develop satisfi bond geometri constraint molecular dynam simul solv system nonlinear constraint equat gaussseidel method approxim solut linear system equat lambda mathbf j_sigma underlinesigma newton iter amount assum mathbf j_sigma diagon domin solv kth equat unknown practic comput lambda_k leftarrow fracsigma_ktparti sigma_ktparti lambda_k mathbf x_kalpha leftarrow mathbf x_kalpha lambda_k fracparti sigma_ktparti mathbf x_kalpha mathbf x_kbeta leftarrow mathbf x_kbeta lambda_k fracparti sigma_ktparti mathbf x_kbeta kdot iter constraint equat sigma_ktdelta solv toler iter shake algorithm cost mathcal oper iter converg linearli nonit form shake develop variant shake algorithm exist differ comput appli constraint constraint model lagrang multipli comput gaussseidel method origin shake algorithm limit mechan system tree structur close loop constraint extens method qshake quaternion shake develop amend work satisfactorili rigid loop aromat ring system fail flexibl loop protein disulfid bond extens includ rattl wiggl mshake rattl work shake veloc verlet time integr scheme wiggl extend shake rattl initi estim lagrang multipli lambda_k base particl veloc final mshake comput correct constraint forc achiev better converg final modif pshake algorithm rigid semirigid molecul pshake comput updat precondition appli constraint gradient shake iter caus jacobian mathbf j_sigma diagon diagon domin decoupl constraint converg faster quadrat oppos linearli cost mathcal mshake algorithm mshake algorithm solv nonlinear system equat newton method directli iter linear system equat underlinelambda leftarrow mathbf j_sigma underlinesigma solv exactli lu decomposit iter cost mathcal oper solut converg quadrat requir fewer iter shake solut propos ciccotti ryckaert titl matrix method differ solut linear system equat ciccotti ryckaert invert matrix mathbf j_sigma directli fist iter iter cost mathcal oper iter cost mathcal oper matrixvector multipl improv cost jacobian longer updat converg linear albeit faster rate shake algorithm linc algorithm altern constraint method linc linear constraint solver develop base earlier method eem modif linc report time faster shake linc appli lagrang multipli constraint forc solv multipli seri expans approxim invers jacobian mathbf j_sigma mathbf mathbf j_sigma mathbf mathbf j_sigma mathbf j_sigma mathbf j_sigma dot step newton iter invers work matric eigenvalu smaller make algorithm suitabl molecul low connect hybrid method hybrid method introduc constraint divid group constraint group solv intern coordin second group solv constraint forc lagrang multipli project method approach pioneer lagrang result lagrang equat mix type molecular dynam softwar molecular mechan model refer footnot laplac ps mcaniqu analytiqu noguti method rapid calcul deriv matrix conform energi larg molecul journal physic societi japan doi jpsj abe braun noguti rapid calcul st deriv conform energi respect dihedr angl protein gener recurr equat comput chemistri doi bae ds haug ej recurs formul constrain mechan system dynam open loop system mechan structur machin jain vaidehi rodriguez fast recurs algorithm molecular dynam simul journal comput physic rice lm brnger torsion angl dynam reduc variabl conform sampl enhanc crystallograph structur refin protein structur function genet doi prot mathiowetz jain karasawa goddard iii wa protein simul techniqu suitabl larg system cell multipol method nonbond interact newtoneul invers mass oper method intern coordin dynam protein structur function genet doi prot mazur ak quasihamiltonian equat motion intern coordin molecular dynam polym journal comput chemistri doi sicixaidjcc gtcok miyamoto kollman pa settl analyt version shake rattl algorithm rigid water model journal comput chemistri doi jcc ryckaert jp ciccotti berendsen hjc numer integr cartesian equat motion system constraint molecular dynam nalkan journal comput physic doi yoneya berendsen hjc hirasawa nonit matrix method constraint moleculardynam simul molecular simul doi forest tr smith shake rattl roll effici constraint algorithm link rigid bodi journal comput chemistri doi sicixaidjcc gtcot mcbride wilson howard jak molecular dynam simul liquid crystal phase atomist potenti molecular physic doi andersen han rattl veloc version shake algorithm molecular dynam calcul journal comput physic doi lee sangho kim palmo samuel krimm wiggl constrain molecular dynam algorithm cartesian coordin journal comput physic doi jjcp gonnet pedro pshake quadrat converg shake mathcal journal comput physic doi jjcp lambrako bori oran chandrasekhar nagumo modifi shake algorithm maintain rigid bond molecular dynam simul larg molecul journal comput physic doi ciccotti ryckaert molecular dynam simul rigid molecul comput physic report doi krutler vincent van gunsteren hnenberg fast shake algorithm solv distanc constraint equat small molecul molecular dynam simul journal comput chemistri doi xaidjcc gtcov edberg evan dj morriss gp constrain moleculardynam simul liquid alkan algorithm journal chemic physic doi hess bekker berendsen hjc fraaij jgem linc linear constraint solver molecular simul journal comput chemistri doi sicixaidjcc gtcoh mazur ak symplect integr close chain rigid bodi dynam intern coordin equat motion journal chemic physic doi baranyai evan dj algorithm constrain moleculardynam simul liquid benzen naphthalen molecular physic doi rodriguez jain kreutzdelgado spatial oper algebra manipul model control intern journal robot doi bae ds haug ej recurs formul constrain mechan system dynam ii close loop system mechan structur machin sommerfeld arnold lectur theoret physic mechan york academ press isbn